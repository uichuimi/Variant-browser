<app-variant-filter-panel></app-variant-filter-panel>

<section class="mat-elevation-z8">
  <div class="row">
    <div class="col-12">
      <app-variant-table-toolbar
        [columnsToDisplay]="columnsToDisplay"
        [onFilterChangeEvent]="onFilterChangeEvent"
        (keyup)="onFilterChange($event)"
        (columnVisualizationChangeEvent)="onColumnVisualizationChange($event)"
      ></app-variant-table-toolbar>
    </div>
  </div>

  <div class="row">
    <div class="col 12">
      <table mat-table
             [dataSource]="dataSource" multiTemplateDataRows
             matSort cdkDropList
             [cdkDropListData]="displayedColumns"
             cdkDropListOrientation="horizontal"
             (cdkDropListDropped)="drop($event)"
             (matSortChange)="sortData($event)"
      >
        <ng-container [matColumnDef]="column.name" *ngFor="let column of columnsToDisplay">
          <th mat-header-cell
              cdkDrag
              *matHeaderCellDef
              mat-sort-header
          >
            {{column.label}}
          </th>
          <td mat-cell *matCellDef="let element"
              class="truncate-cell"
              [matTooltip]="getTooltip(column.name, element)"
          >
            <a *ngIf="element[column.name] !== '-' && column.name === 'snpId'"
               href="https://www.ncbi.nlm.nih.gov/snp/{{element[column.name]}}"
               target="_blank">
              {{element[column.name]}}
            </a>
            <span *ngIf="element[column.name] === '-' || column.name !== 'snpId'">
              {{element[column.name]}}
            </span>
          </td>
          <td mat-footer-cell *matFooterCellDef
              [attr.colspan]="displayedColumns.length"
          >
            Filtered {{dataSource.totalFilteredVariants}} of {{dataSource.totalVariants}} variants.
          </td>
        </ng-container>
        <thead>
        <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
        </thead>
        <tbody>
          <tr mat-row
              *matRowDef="let row; columns: displayedColumns;"
          ></tr>
          <tr class="mat-row" *matNoDataRow>
            <td class="mat-cell"
                [attr.colspan]="displayedColumns.length"
                *ngIf="dataSource.noResult$ | async"
            >
              No data matching the search value.
            </td>
            <td class="spinner-container centered"
                [attr.colspan]="displayedColumns.length"
                *ngIf="dataSource.loading$ | async"
            >
              <mat-spinner></mat-spinner>
            </td>
          </tr>
          <tr mat-footer-row
              id="variant-table-footer"
              *matFooterRowDef="[displayedColumns[0]]; sticky: true"
              class="mat-table-row-sm position-relative mat-footer-row"
          ></tr>
        </tbody>
      </table>

      <mat-paginator
        [length]="dataSource.totalFilteredVariants"
        [pageSize]="size"
        [pageIndex]="page"
        [pageSizeOptions]="[5, 10, 25, 50, 100, 200]"
        aria-label="Select page of users"
        showFirstLastButtons
      ></mat-paginator>
    </div>
  </div>
</section>


<!--<div class="container text-center">
  <div class="row">
    <div class="col">
      &lt;!&ndash; FILTRO DE GENOTIPOS &ndash;&gt;
      <div class="row">
        <div class="toggleButtons">
          <button (click)="toggleProperty('properties')">Properties filter</button>
          <button (click)="toggleProperty('genotypes')">Genotypes filter</button>
        </div>
        <app-properties-filter
          *ngIf="filterToShow === 'properties'"
          (resetPageEvent)="resetShownVariants()"
          (notifyFilterEvent)="setPropertiesFilter($event)"></app-properties-filter>
        <app-genotype-filter
          *ngIf="filterToShow === 'genotypes'"
          (resetPageEvent)="resetShownVariants()"
          (notifyFilterEvent)="setGenotypeTypesFilter($event)"></app-genotype-filter>
      </div>

      &lt;!&ndash; REF Y ALT COMPLETO DE VARIANTE &ndash;&gt;
      <div id="refAltContainer">
        <span>{{ variantToShow }}</span>
      </div>
    </div>
  </div>

  <div class="row">
    &lt;!&ndash; CABECERA TABLA DE VARIANTE &ndash;&gt;
    <div class="col-12 header">
      <div class="title">
        <h4>Variant</h4>
      </div>
      <div>
        <button  class="button" type="button" onclick="console.log('prueba')">
          <img src="../../../assets/icon/icons8-descargar-64.png" alt="download-button" width="30px" height="30px">
        </button>
      </div>
    </div>

    &lt;!&ndash; CONTENEDOR CARGANDO &ndash;&gt;
    <div *ngIf="loading" class="col-12">
      <img src="../../../assets/icon/icons8-spinner.gif" alt="loading">
    </div>

    &lt;!&ndash; TABLA DE VARIANTES &ndash;&gt;
    &lt;!&ndash;<div class="col">
      <table *ngIf="!loading" class="table">
        <tr class="tableHeader">
            <th>SNP Id</th>
            <th>Coordinate</th>
            <th>Variant</th>
            <th>Change</th>
            <th>Gene</th>
            <th>Consequence</th>
            <th>DP</th>
            <th>Frequency</th>
            <th>GMAF</th>
        </tr>
        <tr
            *ngFor="let variant-line of variants.slice(initial,final);let indice=index"
            (click)="selectVariant(variant-line)"
            [ngClass]="{ 'selected': selectedVariant === variant-line }"
        >
            <td>
                <a id="identifierLink" href="https://www.ncbi.nlm.nih.gov/snp/{{ variant-line.identifier }}" target="_blank">
                    <span *ngIf="variant-line.identifier !== null">{{ variant-line.identifier }}</span>
                </a>
                <span *ngIf="variant-line.identifier === null">-</span>
            </td>
            <td>{{ ucsc[indice] }}:{{ variant-line.position }}</td>
            <td>
                <span *ngIf="variant-line.reference.length < 7 && variant-line.alternative.length < 7">
                    {{ variant-line.reference }} / {{ variant-line.alternative }}
                </span>
                <span *ngIf="variant-line.reference.length >= 7"
                    (mouseover)="mouseOver($event,variant-line.reference,variant-line.alternative)"
                    (mouseleave)="mouseLeave()">
                    {{ variant-line.reference.substring(0,6) }}... / {{ variant-line.alternative }}
                </span>
                <span
                    *ngIf="variant-line.alternative.length >= 7"
                    (mouseover)="mouseOver($event,variant-line.reference,variant-line.alternative)"
                    (mouseleave)="mouseLeave()">
                    {{ variant-line.reference }} / {{ variant-line.alternative.substring(0,6) }}...
                </span>
            </td>
            <td>
                <span *ngIf="variant-line.consequence[0].hgvsp !== null">{{ variant-line.consequence[0].hgvsp }}</span>
                <span *ngIf="variant-line.consequence[0].hgvsp === null">-</span>
            </td>
            <td>{{ geneSymbols[indice] }}</td>
            <td>{{ effect[indice] }}</td>
            <td>{{ dp[indice] }}</td>
            <td>{{ localFrequency[indice] }}</td>
            <td>{{ globalFrequency[indice] }}</td>
        </tr>
    </table>
    </div>&ndash;&gt;
    &lt;!&ndash; TABLA DE DETALLES &ndash;&gt;
    <div class="col-12">
      <table
        id="variants-table"
        data-data-field="variants"
        data-detail-view="true"
        data-detail-formatter="true"
        data-unique-id="id"
        data-height="620"
        data-search="true"
        data-show-columns="true"
        data-pagination="true"
        data-show-export="true"
        data-buttons-align="left"
      >
        <thead>
          <tr>
            <th data-field="snpId" data-title="SNP ID"></th>
            <th data-field="region" data-title="Region"></th>
            <th data-field="variant-line" data-title="Variant"></th>
            <th data-field="consequence" data-title="Consequence"></th>
            <th data-field="gene" data-title="Gene"></th>
            <th data-field="effect" data-title="Effect"></th>
            <th data-field="dp" data-title="DP"></th>
            <th data-field="frequency" data-title="Frequency"></th>
            <th data-field="gmaf" data-title="GMAF"></th>
          </tr>
        </thead>
      </table>
      <table id="table"></table>
    </div>

    &lt;!&ndash; FOOTER TABLA DE VARIANTE &ndash;&gt;
    <div class="col-12">
      <app-table-footer
        [filteredElements]="filteredElements"
        [first]="first"
        [initial]="initial"
        [last]="last"
        [final]="final"
        [totalPages]="totalPages"
        [numberOfElements]="numberOfElements"
        [pageNumber]="pageNumber"
        (prevPageEvent)="prevPage()"
        (nextPageEvent)="nextPage()"
        (firstPageEvent)="firstPage()"
        (lastPageEvent)="lastPage()"></app-table-footer>
    </div>
&lt;!&ndash;    <div class="col" *ngIf="selectedVariant != null">&ndash;&gt;
&lt;!&ndash;      <app-variant-line-details class="variantDetails" [variant-line]="selectedVariant"></app-variant-line-details>&ndash;&gt;
&lt;!&ndash;    </div>&ndash;&gt;
  </div>


</div>-->
